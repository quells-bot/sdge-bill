{% extends "base.html" %}

{% block content %}
<article>
  <header>
    <h1>{% if is_editing %}Edit Bill{% else %}Add Bill{% endif %}</h1>
  </header>

  <form method="POST" action="{% if is_editing %}/bills/update/{{ bill.id }}{% else %}/bills/create{% endif %}">
    {% if error %}
      <mark class="error-message">{{ error }}</mark>
    {% endif %}

    <label>
      Date
      <input
        type="date"
        name="date"
        value="{% if is_editing %}{{ bill.date }}{% elif form %}{{ form.date }}{% else %}{{ default_date }}{% endif %}"
        required
      />
    </label>

    <fieldset>
      <legend>Costs</legend>

      <label>
        Gas ($)
        <input
          type="number"
          name="gas_cost"
          value="{% if is_editing %}{{ bill.gas_cost or '' }}{% elif form %}{{ form.gas_cost }}{% endif %}"
          step="0.01"
          placeholder="0.00"
        />
      </label>

      <label>
        Electricity Delivery ($)
        <input
          type="number"
          name="electricity_delivery_cost"
          value="{% if is_editing %}{{ bill.electricity_delivery_cost or '' }}{% elif form %}{{ form.electricity_delivery_cost }}{% endif %}"
          step="0.01"
          placeholder="0.00"
        />
      </label>

      <label>
        Electricity Generation ($)
        <input
          type="number"
          name="electricity_generation_cost"
          value="{% if is_editing %}{{ bill.electricity_generation_cost or '' }}{% elif form %}{{ form.electricity_generation_cost }}{% endif %}"
          step="0.01"
          placeholder="0.00"
        />
      </label>

      <label>
        Other ($)
        <input
          type="number"
          name="other_cost"
          value="{% if is_editing %}{{ bill.other_cost or '' }}{% elif form %}{{ form.other_cost }}{% endif %}"
          step="0.01"
          placeholder="0.00"
        />
      </label>
    </fieldset>

    <fieldset>
      <legend>Usage</legend>

      <label>
        Gas (therms)
        <input
          type="number"
          name="gas_therms"
          value="{% if is_editing %}{{ bill.gas_therms or '' }}{% elif form %}{{ form.gas_therms }}{% endif %}"
          step="0.01"
          placeholder="0"
        />
      </label>

      <label>
        Electricity On-Peak (kWh)
        <input
          type="number"
          name="electricity_on_peak_kwh"
          value="{% if is_editing %}{{ bill.electricity_on_peak_kwh or '' }}{% elif form %}{{ form.electricity_on_peak_kwh }}{% endif %}"
          step="0.01"
          placeholder="0"
        />
      </label>

      <label>
        Electricity Off-Peak (kWh)
        <input
          type="number"
          name="electricity_off_peak_kwh"
          value="{% if is_editing %}{{ bill.electricity_off_peak_kwh or '' }}{% elif form %}{{ form.electricity_off_peak_kwh }}{% endif %}"
          step="0.01"
          placeholder="0"
        />
      </label>

      <label>
        Electricity Super Off-Peak (kWh)
        <input
          type="number"
          name="electricity_super_off_peak_kwh"
          value="{% if is_editing %}{{ bill.electricity_super_off_peak_kwh or '' }}{% elif form %}{{ form.electricity_super_off_peak_kwh }}{% endif %}"
          step="0.01"
          placeholder="0"
        />
      </label>
    </fieldset>

    <button type="submit">Save</button>
  </form>

  {% if is_editing %}
    <footer>
      <button
        hx-delete="/api/bills/{{ bill.id }}"
        hx-confirm="Are you sure you want to delete this bill?"
        hx-target="body"
        hx-swap="none"
        hx-on::after-request="window.location.href = '/'"
        class="secondary">
        Delete Bill
      </button>
    </footer>
  {% endif %}
</article>
{% endblock %}
